<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gesti√≥n de Promociones - UTP</title>

  <link rel="stylesheet" href="CSS/gestion_promociones.css">
  <link rel="stylesheet" href="CSS/sidebar.css">
</head>

<body>

<div class="layout">

  <!-- SIDEBAR -->
  <aside class="sidebar">
      <div class="brand">
          <h2>UTP</h2>
          <p>promociones</p>
      </div>

      <div class="user-info">
          <div class="user-avatar">üë§</div>
          <p class="user-name">Administrador</p>
      </div>

      <nav class="menu">
          <a href="dashboard_admin.html">üìä Dashboard</a>
          <a href="gestion_menus.html">üçΩ Gesti√≥n de Men√∫s</a>
          <a class="active" href="gestion_promociones.html">üéÅ Promociones</a>
          <a href="usuarios_admin.html">üë• Usuarios</a>
          <a href="ventas.html">üíµ Ventas</a>
      </nav>

      <a href="/logout" class="logout">Cerrar Sesi√≥n</a>
  </aside>

  <!-- CONTENIDO PRINCIPAL -->
  <main class="content">

      <header class="header-main">
        <h1>üéÅ Gesti√≥n de Promociones</h1>
        <p class="subtitle">Administra las promociones y descuentos del sistema</p>
      </header>

      <div class="actions">
          <button id="btnAgregar" class="btn">
            ‚ûï Agregar Promoci√≥n
          </button>
      </div>

      <!-- GRID -->
      <section class="grid-2">

          <!-- TABLA -->
          <div class="card">
              <h3 class="card-title">Promociones Registradas</h3>
              <p class="muted">Gestiona todas las promociones activas e inactivas</p>

              <div class="table-wrapper">
                  <table class="tabla-promociones">
                      <thead>
                          <tr>
                              <th>Nombre</th>
                              <th>Descripci√≥n</th>
                              <th>Descuento</th>
                              <th>Precio (antes ‚Üí oferta)</th>
                              <th>Vigencia</th>
                              <th>Estado</th>
                              <th>Items</th>
                              <th>Stock</th>
                              <th style="text-align:right">Acciones</th>
                          </tr>
                      </thead>
                      <tbody id="tablaBody"></tbody>
                  </table>
              </div>
          </div>

          <!-- COLUMNA DERECHA -->
          <aside class="right-sidebar">

              <div class="card">
                  <h3 class="card-title">Promociones Activas</h3>
                  <div id="cardsContainer" class="promo-cards"></div>
              </div>

              <div class="card">
                  <h3 class="card-title">Estad√≠sticas</h3>
                  <div class="stat-row"><span>Total Promociones</span><strong id="totalPromos">0</strong></div>
                  <div class="stat-row"><span>Activas</span><strong id="activePromos">0</strong></div>
                  <div class="stat-row"><span>Programadas</span><strong id="scheduledPromos">0</strong></div>
                  <div class="stat-row"><span>Expiradas</span><strong id="expiredPromos">0</strong></div>
                  <div class="stat-row"><span>Descuento Promedio</span><strong id="avgDiscount">0%</strong></div>
                  <div class="stat-row"><span>Precio Promedio Real</span><strong id="avgReal">S/0</strong></div>
                  <div class="stat-row"><span>Precio Promedio Oferta</span><strong id="avgOferta">S/0</strong></div>
                  <div class="stat-row"><span>Ahorro Promedio</span><strong id="avgSaving">S/0</strong></div>
                  <div class="stat-row"><span>Stock Total Promos</span><strong id="totalStockPromos">0</strong></div>
              </div>

          </aside>

      </section>

  </main>
</div>

<!-- MODAL -->
<!-- ================= MODAL NUEVA PROMOCI√ìN ================= -->
<div id="modalPromocion" class="modal">
  <div class="modal-content modal-xxl">

    <button class="cerrar" id="closeModal">&times;</button>
    <h2 id="modalTitulo">Nueva Promoci√≥n</h2>

    <form id="formPromocion">

      <input type="hidden" id="promoId">

      <div class="modal-grid">

        <!-- ========= COLUMNA IZQUIERDA ========= -->
        <div class="modal-left">

          <!-- DATOS GENERALES -->
          <section class="modal-section">
            <h4>Datos generales</h4>

            <label>Nombre *</label>
            <input id="nombre" required>

            <label>Descripci√≥n *</label>
            <textarea id="descripcion" rows="2" required></textarea>
          </section>

          <!-- PRODUCTOS -->
          <section class="modal-section">
            <h4>Productos del combo</h4>

            <label>Plato de fondo</label>
            <select id="selectPlatoFondo"></select>

            <label>Entrada</label>
            <select id="selectEntrada"></select>

            <label>Postre</label>
            <select id="selectPostre"></select>

            <label>Bebida</label>
            <select id="selectBebida"></select>
          </section>

          <!-- DESCUENTO / FECHAS / STOCK -->
          <section class="modal-section">
            <h4>Descuento y vigencia</h4>

            <div class="form-row">
              <div>
                <label>Descuento (%)</label>
                <input id="descuento" type="number" min="0" max="100" value="0">
              </div>

              <div>
                <label>Estado</label>
                <select id="estado">
                  <option>Activa</option>
                  <option>Programada</option>
                  <option>Inactiva</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div>
                <label>Fecha Inicio</label>
                <input id="fechaInicio" type="date" required>
              </div>

              <div>
                <label>Fecha Fin</label>
                <input id="fechaFin" type="date" required>
              </div>
            </div>

            <label>Stock disponible *</label>
            <input id="stockMaximo" type="number" min="1" required>

            <small id="stockHint">
              El m√°ximo se calcula seg√∫n el stock de los productos seleccionados.
            </small>

            <p id="stockError" class="error-text"></p>
          </section>

        </div>

        <!-- ========= COLUMNA DERECHA ========= -->
        <aside class="modal-right">

          <div class="preview-box">
            <h4>Vista previa</h4>

            <p><strong>Combo:</strong> <span id="previewItems">Sin seleccionar</span></p>
            <p><strong>Vigencia:</strong> <span id="previewVigencia">-</span></p>

            <div class="preview-divider"></div>

            <p><strong>Precio real:</strong> <span id="precioRealText">S/. 0.00</span></p>
            <p><strong>Precio final:</strong> <span id="precioFinalText">S/. 0.00</span></p>
            <p><strong>Descuento:</strong> <span id="descuentoText">0%</span></p>
            <p><strong>Stock m√°ximo:</strong> <span id="stockComboText">N/A</span></p>
          </div>

        </aside>

      </div>

      <!-- ACCIONES -->
      <div class="modal-actions">
        <button type="button" id="btnCancel" class="btn secondary">Cancelar</button>
        <button type="submit" class="btn">Guardar</button>
      </div>

    </form>
  </div>
</div>

<script src="JS/gestion_promociones.js"></script>

</body>
</html>
